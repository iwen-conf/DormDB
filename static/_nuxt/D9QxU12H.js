const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./C59ZDKiW.js","./BwY6AjUB.js","./BeQt8jzg.js"])))=>i.map(i=>d[i]);
import{g as L,r as x,j as w,k as S,s as $,l as z,n as P,p as j,c,a as t,q as b,M as D,z as o,t as i,b as a,d as B,w as A,v as M,P as R,o as m,C as H}from"./BeQt8jzg.js";import{_ as O}from"./BPnSQfJf.js";import{u as q,_ as F}from"./D4eMZqxZ.js";import{u as G}from"./CELlox2R.js";const J=L("system",()=>{const f=x(null),e=x(!1),_=x(null),v=async()=>{e.value=!0,_.value=null;try{const{apiClient:r}=await S(async()=>{const{apiClient:d}=await import("./C59ZDKiW.js");return{apiClient:d}},__vite__mapDeps([0,1,2]),import.meta.url);f.value=await r.getSystemStatus()}catch(r){_.value=r.message||"获取系统状态失败"}finally{e.value=!1}},y=async()=>{try{const{apiClient:r}=await S(async()=>{const{apiClient:d}=await import("./C59ZDKiW.js");return{apiClient:d}},__vite__mapDeps([0,1,2]),import.meta.url);return await r.healthCheck(),!0}catch{return!1}};return{status:w(f),loading:w(e),error:w(_),fetchStatus:v,healthCheck:y}}),K={class:"min-h-screen bg-gray-50"},Q={class:"bg-white shadow"},U={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},W={class:"flex justify-between items-center py-6"},X={class:"flex items-center"},Y={class:"ml-4 flex items-center"},Z={class:"text-sm text-gray-600"},tt={class:"flex items-center space-x-4"},st=["disabled"],et={class:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8"},ot={class:"px-4 py-6 sm:px-0"},at={class:"mb-8"},nt={key:0,class:"flex justify-center py-8"},lt={key:1,class:"alert alert-error"},it={key:2,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6"},rt={class:"card p-6"},dt={class:"flex items-center"},ct={class:"flex-shrink-0"},mt={class:"ml-5 w-0 flex-1"},ut={class:"text-3xl font-bold text-gray-900"},xt={class:"card p-6"},_t={class:"flex items-center"},ht={class:"flex-shrink-0"},gt={class:"ml-5 w-0 flex-1"},ft={class:"text-3xl font-bold text-gray-900"},vt={class:"card p-6"},yt={class:"flex items-center"},pt={class:"flex-shrink-0"},wt={class:"ml-5 w-0 flex-1"},bt={class:"text-3xl font-bold text-gray-900"},kt={class:"card p-6"},Ct={class:"flex items-center"},St={class:"flex-shrink-0"},Dt={class:"ml-5 w-0 flex-1"},Bt={class:"text-3xl font-bold text-gray-900"},Nt={class:"mb-8"},Tt={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},Vt={class:"flex items-center"},Et={class:"flex-shrink-0"},It={class:"flex items-center"},Lt={class:"flex-shrink-0"},$t={class:"flex items-center"},zt={class:"flex-shrink-0"},Pt={key:0},jt={class:"card p-6"},At={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Mt={class:"text-sm text-gray-900"},Rt={class:"text-sm text-gray-900"},Ht={class:"mt-3"},Jt={__name:"dashboard",setup(f){const e=J(),{status:_,loading:v,error:y}=$(e),{logout:r}=G();q();const{success:d,error:h,info:N}=z(),u=x(!0),g=x(!1),p=async()=>{try{await e.fetchStatus(),await k(),d("数据刷新成功")}catch{h("刷新数据失败")}},k=async()=>{try{u.value=await e.healthCheck(),d("系统健康检查完成")}catch{h("健康检查失败")}},T=async()=>{try{await r(),N("已安全退出登录"),await R("/admin/login")}catch{h("退出登录失败")}},V=l=>new Date(l).toLocaleString("zh-CN");return P(y,l=>{l&&h(l)}),j(()=>{p()}),(l,s)=>{const n=H,E=O,I=F;return m(),c("div",K,[t("header",Q,[t("div",U,[t("div",W,[t("div",X,[s[4]||(s[4]=t("h1",{class:"text-2xl font-bold text-gray-900"},"DormDB 管理面板",-1)),t("div",Y,[t("div",{class:D(["w-2 h-2 rounded-full mr-2",o(u)?"bg-green-500":"bg-red-500"])},null,2),t("span",Z,i(o(u)?"系统正常":"系统异常"),1)])]),t("div",tt,[t("button",{onClick:p,class:"btn btn-secondary",disabled:o(v)},[a(n,{name:"heroicons:arrow-path",class:"w-4 h-4 mr-2"}),s[5]||(s[5]=B(" 刷新 "))],8,st),t("button",{onClick:T,class:"btn btn-secondary"},[a(n,{name:"heroicons:arrow-right-on-rectangle",class:"w-4 h-4 mr-2"}),s[6]||(s[6]=B(" 退出 "))])])])])]),t("main",et,[t("div",ot,[t("div",at,[s[11]||(s[11]=t("h2",{class:"text-lg font-medium text-gray-900 mb-4"},"系统统计",-1)),o(e).loading?(m(),c("div",nt,[a(n,{name:"svg-spinners:90-ring",class:"w-8 h-8 text-blue-600"})])):o(e).error?(m(),c("div",lt,i(o(e).error),1)):o(e).status?(m(),c("div",it,[t("div",rt,[t("div",dt,[t("div",ct,[a(n,{name:"heroicons:document-text",class:"w-8 h-8 text-blue-600"})]),t("div",mt,[t("dl",null,[s[7]||(s[7]=t("dt",{class:"text-sm font-medium text-gray-500 truncate"},"总申请数",-1)),t("dd",ut,i(o(e).status.total_count),1)])])])]),t("div",xt,[t("div",_t,[t("div",ht,[a(n,{name:"heroicons:calendar-days",class:"w-8 h-8 text-green-600"})]),t("div",gt,[t("dl",null,[s[8]||(s[8]=t("dt",{class:"text-sm font-medium text-gray-500 truncate"},"今日申请",-1)),t("dd",ft,i(o(e).status.today_count),1)])])])]),t("div",vt,[t("div",yt,[t("div",pt,[a(n,{name:"heroicons:check-circle",class:"w-8 h-8 text-green-600"})]),t("div",wt,[t("dl",null,[s[9]||(s[9]=t("dt",{class:"text-sm font-medium text-gray-500 truncate"},"成功申请",-1)),t("dd",bt,i(o(e).status.successful_count),1)])])])]),t("div",kt,[t("div",Ct,[t("div",St,[a(n,{name:"heroicons:x-circle",class:"w-8 h-8 text-red-600"})]),t("div",Dt,[t("dl",null,[s[10]||(s[10]=t("dt",{class:"text-sm font-medium text-gray-500 truncate"},"失败申请",-1)),t("dd",Bt,i(o(e).status.failed_count),1)])])])])])):b("",!0)]),t("div",Nt,[s[15]||(s[15]=t("h2",{class:"text-lg font-medium text-gray-900 mb-4"},"快速操作",-1)),t("div",Tt,[a(E,{to:"/admin/students",class:"card p-6 hover:shadow-lg transition-shadow"},{default:A(()=>[t("div",Vt,[t("div",Et,[a(n,{name:"heroicons:users",class:"w-8 h-8 text-blue-600"})]),s[12]||(s[12]=t("div",{class:"ml-4"},[t("h3",{class:"text-lg font-medium text-gray-900"},"学号管理"),t("p",{class:"text-sm text-gray-500"},"管理学生学号白名单")],-1))])]),_:1}),t("button",{onClick:s[0]||(s[0]=C=>g.value=!0),class:"card p-6 hover:shadow-lg transition-shadow text-left"},[t("div",It,[t("div",Lt,[a(n,{name:"heroicons:arrow-up-tray",class:"w-8 h-8 text-green-600"})]),s[13]||(s[13]=t("div",{class:"ml-4"},[t("h3",{class:"text-lg font-medium text-gray-900"},"批量导入"),t("p",{class:"text-sm text-gray-500"},"批量导入学生学号")],-1))])]),t("button",{onClick:k,class:"card p-6 hover:shadow-lg transition-shadow text-left"},[t("div",$t,[t("div",zt,[a(n,{name:"heroicons:heart",class:"w-8 h-8 text-red-600"})]),s[14]||(s[14]=t("div",{class:"ml-4"},[t("h3",{class:"text-lg font-medium text-gray-900"},"健康检查"),t("p",{class:"text-sm text-gray-500"},"检查系统运行状态")],-1))])])])]),o(e).status?(m(),c("div",Pt,[s[18]||(s[18]=t("h2",{class:"text-lg font-medium text-gray-900 mb-4"},"系统信息",-1)),t("div",jt,[t("div",At,[t("div",null,[s[16]||(s[16]=t("dt",{class:"text-sm font-medium text-gray-500"},"最后更新时间",-1)),t("dd",Mt,i(V(o(e).status.last_updated)),1)]),t("div",null,[s[17]||(s[17]=t("dt",{class:"text-sm font-medium text-gray-500"},"系统状态",-1)),t("dd",Rt,[t("span",{class:D(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",o(u)?"bg-green-100 text-green-800":"bg-red-100 text-red-800"])},i(o(u)?"正常运行":"异常"),3)])])])])])):b("",!0)])]),o(g)?(m(),c("div",{key:0,class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",onClick:s[3]||(s[3]=C=>g.value=!1)},[t("div",{class:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",onClick:s[2]||(s[2]=M(()=>{},["stop"]))},[t("div",Ht,[s[19]||(s[19]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"批量导入学号",-1)),a(I,{onClose:s[1]||(s[1]=C=>g.value=!1),onSuccess:p})])])])):b("",!0)])}}};export{Jt as default};
